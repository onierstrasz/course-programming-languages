%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 60 80 550 570

% Postscript Language Tutorial and Cookbook, Addison-Wesley, 1985
% p. 141

/arrowdict 14 dict def				% make a new dictionary

arrowdict begin
	/mtrx matrix def			% allocate space for a matrix
end

/arrow {
    arrowdict begin				% open the dictionary
	/headlength exch def			% pick up the arguments
	/halfheadthickness exch 2 div def
	/halfthickness exch 2 div def
	/tipy exch def
	/tipx exch def
	/taily exch def
	/tailx exch def

	/dx tipx tailx sub def
	/dy tipy taily sub def
	/arrowlength dx dx mul dy dy mul add sqrt def
	/angle dy dx atan def
	/base arrowlength headlength sub def

	mtrx currentmatrix 	% save the coordinate system
	pop

	tailx taily translate			% translate to start of arrow
	angle rotate				% rotate coordinates

	0 halfthickness neg moveto		% draw as if starting from (0,0)
	base halfthickness neg lineto
	base halfheadthickness neg lineto
	arrowlength 0 lineto
	base halfheadthickness lineto
	base halfthickness lineto
	0 halfthickness lineto
	closepath

	mtrx setmatrix			% restore coordinate system
    end
} def

newpath
	318 340 72 340 10 30 72 arrow
fill

newpath
	382 400 542 560 72 232 116 arrow
3 setlinewidth stroke

newpath
	400 300 400 90 90 200 200 3 sqrt mul 2 div arrow
	.65 setgray fill

showpage

